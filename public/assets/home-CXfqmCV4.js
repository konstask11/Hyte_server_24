import"./modulepreload-polyfill-B5Qt9EMX.js";let y=localStorage.getItem("name");document.getElementById("name").innerHTML=y;const g=document.querySelector(".get_users");g.addEventListener("click",E);async function E(){console.log("Button clicked!");try{const e=localStorage.getItem("token"),r=await(await fetch("https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/users",{headers:{Authorization:"Bearer: "+e}})).json();console.log(r);const s=document.querySelector(".tbody");s.innerHTML="",r.forEach(o=>{console.log(o.username);let n=document.createElement("tr"),d=document.createElement("td");d.innerText=o.username;let l=document.createElement("td");l.innerText=o.user_level;let i=document.createElement("td"),a=document.createElement("button");a.className="check",a.setAttribute("data-id","1"),a.innerText="Info",a.addEventListener("click",()=>w(o.user_id)),i.appendChild(a);let u=document.createElement("td"),c=document.createElement("button");c.className="del",c.setAttribute("data-id","1"),c.innerText="Delete",c.innerText="Delete",c.addEventListener("click",()=>v(o.user_id)),u.appendChild(c);let p=document.createElement("td");p.innerText=o.user_id,n.appendChild(d),n.appendChild(l),n.appendChild(i),n.appendChild(u),n.appendChild(p),s.appendChild(n)})}catch(e){console.log(e)}}async function w(e){try{const t=localStorage.getItem("token"),s=await(await fetch(`https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/users/${e}`,{method:"GET",headers:{Authorization:"Bearer: "+t}})).json();console.log(s),f(s)}catch(t){console.error("Error fetching user data:",t)}}function f(e){const t=document.querySelector(".info_dialog"),r=t.querySelectorAll("span");r[0].innerText=e.user_id,r[1].innerText=e.username,r[2].innerText=e.email,r[3].innerText=e.user_level,t.showModal(),t.querySelector("button[autofocus]").addEventListener("click",()=>{t.close()})}async function v(e){try{const t=localStorage.getItem("token");if(!confirm(`Are you sure you want to delete the user with ID: ${e}?`))return;if(!(await fetch(`https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/users/${e}`,{method:"DELETE",headers:{Authorization:"Bearer: "+t}})).ok)throw new Error("Failed to delete user");console.log("User deleted successfully")}catch(t){console.error("Error deleting user:",t)}}async function k(e){try{const t=localStorage.getItem("token");if(!confirm(`Are you sure you want to delete the entry with ID: ${e}?`))return;if(!(await fetch(`https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/entries/${e}`,{method:"DELETE",headers:{Authorization:"Bearer: "+t}})).ok)throw new Error("Failed to delete entry");console.log("entry deleted successfully")}catch(t){console.error("Error deleting entry:",t)}}const T=document.getElementById("postUserButton");T.addEventListener("click",async()=>{const e=document.getElementById("username").value,t=document.getElementById("password").value,r=document.getElementById("email").value,s={username:e,password:t,email:r};try{if(!(await fetch("https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Failed to add user");window.alert("User added successfully")}catch(o){window.alert("Error adding user: "+o.message)}});const S=document.getElementById("putUserButton");S.addEventListener("click",async()=>{const e=localStorage.getItem("token"),t=document.getElementById("username").value,r=document.getElementById("password").value,s=document.getElementById("email").value,o={username:t,password:r,email:s};try{if(!(await fetch("https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/users/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(o)})).ok)throw new Error("Failed to update user");window.alert("User updated successfully")}catch(n){window.alert("Error updating user: "+n.message)}});const C=document.getElementById("sleepForm");C.addEventListener("click",async()=>{const e=localStorage.getItem("token"),t=prompt("Syötä entry_id:"),r=prompt("Syötä entry_date (muodossa YYYY-MM-DD):"),s=prompt("Syötä mood:"),o=parseFloat(prompt("Syötä weight:")),n=parseFloat(prompt("Syötä sleep_hour:")),d=prompt("Syötä notes:"),l=new Date().toISOString(),i={entry_id:t,entry_date:r,mood:s,weight:o,sleep_hour:n,notes:d,created_at:l};try{if(!(await fetch("https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/entries/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(i)})).ok)throw new Error("Failed to update entry");window.alert("Entry updated successfully")}catch(a){window.alert("Error updating entry: "+a.message)}});const I=document.querySelector("get_entry");I.addEventListener("click",B);async function B(){console.log("Button clicked!");try{const e=localStorage.getItem("token"),r=await(await fetch("https://hyte-server-vichy.northeurope.cloudapp.azure.com/api/entries",{headers:{Authorization:"Bearer: "+e}})).json();console.log(r);const s=document.querySelector(".tbody1");s.innerHTML="",r.forEach(o=>{let n=document.createElement("tr"),d=document.createElement("td");d.innerText=o.entry_id;let l=document.createElement("td");l.innerText=o.entry_date;let i=document.createElement("td");i.innerText=o.mood;let a=document.createElement("td");a.innerText=parseFloat(o.weight).toFixed(2);let u=document.createElement("td");u.innerText=parseInt(o.sleep_hours);let c=document.createElement("td");c.innerText=o.notes;let p=document.createElement("td");p.innerText=o.created_at;let h=document.createElement("td"),m=document.createElement("button");m.className="del",m.setAttribute("data-id",o.entry_id),m.innerText="Delete",m.addEventListener("click",()=>k(o.entry_id)),h.appendChild(m),n.appendChild(d),n.appendChild(l),n.appendChild(i),n.appendChild(a),n.appendChild(u),n.appendChild(c),n.appendChild(p),n.appendChild(h),s.appendChild(n)})}catch(e){console.log(e)}}document.querySelector(".logout").addEventListener("click",_);function _(e){e.preventDefault(),localStorage.removeItem("token"),console.log("logginout"),window.location.href="index.html"}
