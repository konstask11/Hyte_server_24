import"./modulepreload-polyfill-B5Qt9EMX.js";const l=async(a,s={})=>{let e;try{const o=await fetch(a,s);if(!o.ok)throw new Error(`HTTP ${o.status} - ${o.statusText}`);e=await o.json()}catch(o){console.error("fetchData() error",o),e={}}return e},u=document.querySelector(".createuser");u.addEventListener("click",async a=>{a.preventDefault(),console.log("Nyt luodaan käyttäjä");const s="http://127.0.0.1:3000/api/users",e=document.querySelector(".create_user_form"),o={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value,email:e.querySelector("input[name=email]").value};try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},r=await fetch(s,t);if(!r.ok){if(r.status===500)throw new Error("Database error");if(r.status===400)throw new Error("Invalid username/password or email")}const n=await r.json();console.log(n),alert("User created successfully!"),e.querySelector("input[name=username]").value="",e.querySelector("input[name=password]").value="",e.querySelector("input[name=email]").value=""}catch(t){console.error("Error creating user:",t),t.message==="Database error"?alert("Database error occurred. Please try again later."):t.message==="Invalid username/password or email"?alert("Invalid username/password or email."):alert("An unknown error occurred. Please try again later.")}});const c=document.querySelector(".loginuser");c.addEventListener("click",async a=>{a.preventDefault(),console.log("Nyt logataan sisään");const s="http://localhost:3000/api/auth/login",e=document.querySelector(".login_form"),o={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value},t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)};l(s,t).then(r=>{console.log(r),console.log(r.token),localStorage.setItem("token",r.token),r.token==null?(alert("Invalid password or username!"),e.querySelector("input[name=username]").value="",e.querySelector("input[name=password]").value=""):alert("Login succesful!"),localStorage.setItem("name",r.user.username),localStorage.setItem("user_level",r.user.user_level),window.location.href="home.html",logResponse("loginResponse",`localStorage set with token value: ${r.token}`)})});
